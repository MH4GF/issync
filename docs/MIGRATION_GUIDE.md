# plan-template.md Migration Guide

このドキュメントは、plan-template.mdのバージョン間の変更内容とマイグレーション手順を記録します。

## バージョン管理の方針

- **バージョン番号**: 単純な整数（1, 2, 3...）を使用
- **日付**: バージョン番号と共に日付を併記（例: `<!-- Template Version: 1 (2025-10-15) -->`）
- **マイグレーション**: このガイドを参照して、既存のplan.mdを新しいバージョンに更新

**全バージョン共通のマイグレーション最終ステップ**: 変更適用後、plan.mdのバージョンヘッダー（2行目）を対象バージョンに更新

## Version 1-4 (2025-10-15)

**主な変更:**
- v1: 初期バージョン（11セクション構成、HTMLコメントガイダンス）
- v2: Open Questionsのカテゴリ構造削除（フラット化）
- v3: 更新ガイドラインをHTMLコメント化
- v4: issyncマーカー追加（`<!-- issync:v1:start/end -->`）

**マイグレーション**: カテゴリ見出し削除 → ガイドラインHTMLコメント化 → issyncマーカー追加

---

## Version 5-6 (2025-10-16)

**主な変更:**
- v5: TasksセクションのGitHub Issue連携ガイダンスをHTMLコメント化
- v6: Tasks作成タイミングを`before-plan`→`before-architecture-decision`に変更

**マイグレーション**: ガイダンスをHTMLコメント内に移動し、記入タイミングを更新

---

## Version 7 (2025-10-17)

### 変更内容

**TasksセクションをGitHub Sub-issuesに完全移行 - 破壊的変更**

**削除セクション**: Tasks
**変更セクション数**: 11セクション → 10セクション
**理由**:
- GitHub Sub-issuesをSingle Source of Truth（SSOT）とし、データの重複を排除
- タスク管理の一元化により、plan.mdの簡素化と保守性向上
- `/create-sub-issue`コマンドでタスク作成を簡素化

**影響するコマンド**:
- `/create-sub-issue` → `/create-sub-issue`に名称変更・仕様変更
- `/complete-sub-issue` → Tasksセクション更新処理を削除
- `/plan` → Tasks初期化処理を削除（5ステップワークフローに変更）

**トレードオフ**: plan.mdでのタスク一覧性が低下、GitHub Projects/APIでの確認が必要

### マイグレーション手順

#### 1. Tasksセクション全体を削除

`## Tasks` 見出しから次の`---`までを削除

#### 2. 既存タスクの移行（オプション）

**選択肢A**: `/create-sub-issue`でGitHub Sub-issuesに移行後、Tasksセクション削除
**選択肢B**: Tasksセクションを残し、新規タスクのみSub-issuesとして作成

#### 3. コマンド使用方法の変更

`/create-sub-issue "タスク名"`でタスク作成（旧`/create-sub-issue`から変更）

---

## Version 8 (2025-10-17)

### 変更内容

**Inboxセクションを追加 - 人間専用の整理前メモエリア**

**追加セクション**: Inbox（人間が整理前のメモ、リンク、一時的な情報を記入。AIは記入しない）
**理由**: 断片的な情報を一時保管し、各セクションに書き込む前に人間が整理するスクラッチエリアを提供。AI/人間の役割を明確に分離

### マイグレーション手順

`<!-- issync:v1:end -->`の直前に以下を挿入:

```markdown
---

## Inbox

<!--
📝 Guidance for AI
記入タイミング: **人間が記入** - AIは記入しない
記入内容: 整理前のメモ、リンク、一時的な情報など。人間が後で適切なセクションに整理する
-->

[人間が記入する整理前の情報やメモ]
```

**注意**: Inboxは人間専用。整理完了後は適切なセクションに移動し、Inboxから削除を推奨

---

## マイグレーションツールの使用方法

### `/compact-plan` コマンド

plan.mdのバージョンをチェックし、マイグレーションをサポート

**動作**: バージョンヘッダー読み取り → 最新版と比較 → マイグレーション提案 → 承認後実行

### 手動バージョン確認

plan.md先頭行 `<!-- Template Version: X (YYYY-MM-DD) -->` を確認し、最新版と比較

---

## トラブルシューティング

**バージョンヘッダーがない**: plan.md先頭に `<!-- Template Version: 1 (YYYY-MM-DD) -->` を追加し、現在の構造から最も近いバージョンを特定

**マイグレーション失敗**: GitHub Issueのコメント履歴からバックアップを確認し、手動で手順を実施

---

## 更新履歴

- **Version 8 (2025-10-17)**: Inboxセクションを追加（人間専用の整理前メモエリア）
- **Version 7 (2025-10-17)**: TasksセクションをGitHub Sub-issuesに完全移行（破壊的変更）
- **Version 6 (2025-10-16)**: TasksセクションのAIガイダンス更新（before-planでの作成を廃止）
- **Version 5 (2025-10-16)**: TasksセクションのGitHub Issue連携ガイダンスをHTMLコメント化
- **Version 4 (2025-10-15)**: issyncマーカーをテンプレートに追加
- **Version 3 (2025-10-15)**: 更新ガイドラインをHTMLコメント化
- **Version 2 (2025-10-15)**: Open Questions セクションのカテゴリ構造を削除
- **Version 1 (2025-10-15)**: 初期バージョン
