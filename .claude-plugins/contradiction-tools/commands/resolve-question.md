---
description: 決定事項の記録、質問の解決済みマーク、タスク更新によりOpen Question解消ワークフローを自動化
---

# /resolve-question: Open Question解消ワークフロー

あなたはユーザーのplan.mdファイル内のOpen Questionを解決するサポートをしています。このコマンドは以下のワークフローを自動化します：
1. Decision Logへの決定事項の記録
2. Open Questionの解決済みマーク
3. 関連タスクの更新

## 使用方法

```bash
/resolve-question                    # 引数なし: .issync/state.ymlから選択
/resolve-question <file_path>        # 明示的パス指定（後方互換性）
```

**引数**:
- `file_path` (オプション): 対象のplan.mdファイルのパス
  - 省略時: `.issync/state.yml`から同期中のファイルを選択
  - 明示的指定: `/resolve-question docs/plan.md`

## コンテキスト

このコマンドは「矛盾解消駆動開発」ワークフローの一部です：
- Open Questionsは開発中に出現します（特にPOCや実装フェーズ）
- 質問は調査と検証を通じて答えられます
- 決定事項は体系的に記録されます
- タスクは新たな発見に基づいて更新されます

このワークフローは**どのステートでも発生**します（plan、poc、architecture-decision、implement）- これはステート遷移とは独立した横断的オペレーションです。

## 実行フロー

### ステップ1: state.ymlの確認と選択

**引数が指定されている場合**: そのパスを使用し、このステップをスキップして次へ進んでください。

**引数が指定されていない場合**: `.issync/state.yml`を読み込み、同期中のファイル一覧を表示してください。

**state.ymlが存在しない/syncsが空の場合**:
```
エラー: .issync/state.ymlが見つからないか、同期中のファイルがありません。
明示的にパスを指定してください: /resolve-question <file_path>
```

**複数ファイルがある場合**: 選択を促してください
```
対象のplan.mdを選択してください:
1. .issync/docs/task-dashboard.md (最終同期: 2025-10-14T08:20:50Z, Issue: route06/liam-internal/issues/5829)
2. docs/plan.md (最終同期: 2025-10-14T07:07:44Z, Issue: MH4GF/issync/issues/1)

番号を入力してください (1-2):
```

**1つのみの場合**: 確認を表示して自動選択
```
対象: .issync/docs/task-dashboard.md
  最終同期: 2025-10-14T08:20:50Z
  Issue: route06/liam-internal/issues/5829

このファイルのOpen Questionを解決しますか? (y/n)
```

### ステップ2: 必要な入力の収集

ユーザーに以下の情報を尋ねてください：

1. **Open Question ID** (例: Q1, Q2, Q5)
   - どの質問を解決しますか？

2. **決定内容のサマリー**
   - 何を決定しましたか？（選択したアプローチ/解決策）
   - なぜこの決定をしましたか？（主な理由）
   - トレードオフは何ですか？（制約や今後の考慮事項）

3. **タスクへの影響**
   - この決定から生まれた新しいタスクはありますか？
   - 不要になった既存のタスクはありますか？

### ステップ3: Decision Logを更新

plan.mdの**Decision Log**セクションに新しいエントリを追加：

```markdown
**YYYY-MM-DD: [決定事項のタイトル]**

- **採用**: [選択したアプローチ/解決策]
- **理由**:
  - [理由1]
  - [理由2]
- **比較検討した候補**: [検討した他の選択肢があれば]
- **トレードオフ**: [制約や今後の考慮事項]
- **Open Question**: [Question ID] を解決
```

### ステップ4: Open Questionを解決済みとしてマーク

**Open Questions / 残論点**セクションでOpen Questionを見つけて更新：

**変更前:**
```markdown
**Q1: [質問のタイトル]**

- [質問の詳細]
- [検討した選択肢]
```

**変更後:**
```markdown
**Q1: [質問のタイトル]** ✅ 解決済み (YYYY-MM-DD)

- **回答**: [決定内容の簡潔なサマリー]
- **詳細**: Decision Log参照
```

### ステップ5: タスクを更新

**Tasks**セクションで：

1. 決定から生まれた**新しいタスクを追加**（あれば）
2. もはや関連性のない**タスクを削除または完了マーク**（あれば）
3. タスクリストをフェーズごとに整理して保つ

### ステップ6: 自動同期

**注意**: issyncのwatchモードが起動している場合は、ファイルの変更が自動的にGitHub Issueに同期されます。明示的なpushコマンドは不要です。

## 出力フォーマット

更新完了後、以下の形式でサマリーを提供：

```markdown
## /resolve-question 実行結果

### 解決したOpen Question
- [Question ID]: [質問のタイトル]

### 更新内容
- ✅ Decision Log更新: [決定事項のタイトル] (plan.md:[line_number])
- ✅ Open Question [Question ID]に回答記載 (plan.md:[line_number])
- ✅ Tasks更新: [X]件追加、[Y]件削除

### 次のアクション
- [ ] 更新内容をレビューしてください
- [ ] 必要に応じて関連するOpen Questionsも見直してください
- [ ] Work PlanやSpecificationへの影響を確認してください
```

## 重要な注意事項

- 変更を行う前に**必ず対象のplan.mdファイルを読んでください**
- 各セクションの**既存のフォーマットと構造を保持**してください
- タイムスタンプには**今日の日付を使用**してください（YYYY-MM-DD形式）
- ユーザーの決定内容に詳細が不足している場合は、続行する前に**明確化の質問をしてください**
- 問題が発生した場合（例: Question IDが見つからない）、**明確に報告**してガイダンスを求めてください
- **元のOpen Questionは削除しないでください** - 解決済みとしてマークし、回答を追加するだけです

## 実行例

**ユーザー:** `/resolve-question`

**アシスタント:** "Open Questionの解決をサポートします。まず、現在の状態を確認するためにplan.mdを読みます。

どのOpen Questionを解決しますか？（例: Q1, Q2）

また、以下を教えてください：
- あなたが決定した内容（どのアプローチを選択しましたか？）
- なぜこの決定をしたか（主な理由）
- トレードオフや制約
- 新しいタスクまたは既存タスクの変更"

**ユーザー:** "Q5についてissync init実行。Devin Searchがローカルファイルシステムにアクセスできないため、人間がローカルで実行することに決定。トレードオフは手動セットアップが必要なこと。新しいタスクはなし。"

**アシスタント:** [plan.mdを読み、Decision Log、Open Questionsを更新、タスク変更がないことを確認、サマリー出力を提供。watchモードが起動している場合は自動的にGitHub Issueに同期される]
