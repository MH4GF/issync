# Lefthook configuration for issync
# Enforces code quality checks before commits
# For AI Agents: All checks must pass before a task is considered complete

pre-commit:
  commands:
    plugin-version-check:
      # Ensure plugin.json version is updated when .claude-plugins/ files change
      glob: ".claude-plugins/**/*"
      run: ./scripts/check-plugin-version.sh
      fail_text: |
        ❌ Plugin version not updated.

        When modifying files in .claude-plugins/, you must also update
        the version in the corresponding plugin.json file.

    quality-check:
      # Run comprehensive quality checks on the entire project
      # This ensures all code meets standards before committing
      glob: "**/*.{ts,tsx,js,jsx,json,yml,yaml,md}"
      run: bun run check:ci
      fail_text: |
        ❌ Quality checks failed.

        FOR AI AGENTS: Please fix all errors before committing.
        The task is NOT complete until all checks pass:
        - Linting (Biome + ESLint)
        - Formatting (Biome)
        - Type checking (TypeScript)
        - Tests (Bun Test)

        Run: bun run check:ci

        To temporarily skip (humans only): LEFTHOOK=0 git commit
